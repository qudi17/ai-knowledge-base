# RAGæŸ¥è¯¢æ”¹å†™æ–¹æ³•å¯¹æ¯”ç ”ç©¶

> æ—¥æœŸï¼š2026-02-23
> ç›®æ ‡ï¼šç ”ç©¶å¹¶å¯¹æ¯”6ç§ä¸»æµçš„RAGæŸ¥è¯¢æ”¹å†™æ–¹æ³•

---

## æ–¹æ³•æ¦‚è§ˆ

| æ–¹æ³• | æ ¸å¿ƒæ€æƒ³ | ä¼˜åŠ¿ | åŠ£åŠ¿ | å¤æ‚åº¦ |
|------|---------|------|------|--------|
| **HyDE** | ç”Ÿæˆå‡è®¾æ€§æ–‡æ¡£ï¼Œç”¨å‡è®¾åµŒå…¥æ£€ç´¢ | ç®€å•æ˜“ç”¨ï¼Œæ•æ‰æ„å›¾ | å¯èƒ½äº§ç”Ÿå¹»è§‰ | ä½ |
| **LLM4CS** | æŸ¥è¯¢æ”¹å†™ â†’ æ£€ç´¢ â†’ å¤šè½®å¯¹è¯ | ç²¾å‡†æ”¹å†™ï¼Œé€‚åˆå¤æ‚æŸ¥è¯¢ | è®¡ç®—æˆæœ¬é«˜ | é«˜ |
| **Query2Doc** | æŸ¥è¯¢è½¬é•¿æ–‡æ¡£ï¼Œå¢å¼ºè¯­ä¹‰ | ä¿ç•™ç»†èŠ‚ï¼Œä¸°å¯Œä¸Šä¸‹æ–‡ | æ–‡æœ¬å†—é•¿ | ä¸­ |
| **Rewrite-Retrieve-Read** | æ”¹å†™ â†’ æ£€ç´¢ â†’ é‡è¯»éªŒè¯ | å¯æ§æ€§å¼ºï¼Œè´¨é‡é«˜ | å¤šæ¬¡LLMè°ƒç”¨ | ä¸­ |
| **Iter-RetGen** | è¿­ä»£æ£€ç´¢ç”Ÿæˆï¼Œå¾ªç¯ä¼˜åŒ– | æŒç»­æ”¹è¿›ï¼Œè‡ªé€‚åº” | æ…¢ï¼Œä¸å¯æ§ | é«˜ |
| **STEP-BACK Prompting** | æ­¥æ­¥é€€ååˆ°å®è§‚é—®é¢˜ | è§†è§’æ¸…æ™°ï¼Œå‡å°‘å±€éƒ¨æ­§ä¹‰ | å¯èƒ½ä¸¢å¤±ç»†èŠ‚ | ä½ |

---

## è¯¦ç»†åˆ†æ

### 1. HyDE (Hypothetical Document Embeddings)

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
ç”Ÿæˆå‡è®¾æ€§æ–‡æ¡£ï¼ˆç”¨LLMï¼‰
  â†“
ç”¨å‡è®¾æ€§æ–‡æ¡£çš„åµŒå…¥æ£€ç´¢
  â†“
ä½¿ç”¨æ··åˆç›¸ä¼¼åº¦ï¼ˆå‡è®¾ + åŸå§‹æŸ¥è¯¢ï¼‰
```

#### å…³é”®ç‰¹ç‚¹
- **å‡è®¾æ€§æ–‡æ¡£ç”Ÿæˆ**ï¼šLLMç”Ÿæˆä¸€ä¸ª"å¥½åƒå­˜åœ¨"çš„ç­”æ¡ˆ/æ–‡æ¡£
- **æ··åˆç›¸ä¼¼åº¦**ï¼š`sim(query, hyp_doc) + sim(query, retrieved_doc)`
- **æ ¸å¿ƒæ€æƒ³**ï¼šLLMæ“…é•¿ç”Ÿæˆå†…å®¹ï¼Œå³ä½¿å†…å®¹æ˜¯å‡çš„ï¼Œå…¶æ„å›¾æ˜¯çœŸå®çš„

#### ç¤ºä¾‹
```python
# ç”¨æˆ·æŸ¥è¯¢
query = "å¦‚ä½•ç”¨Pythonè¿æ¥MySQLæ•°æ®åº“ï¼Ÿ"

# ç”Ÿæˆå‡è®¾æ€§æ–‡æ¡£
hyp_doc = "To connect to MySQL in Python, you need to use the mysql-connector-python library. First, install it via pip: pip install mysql-connector-python. Then use the connect() function..."

# ç”¨å‡è®¾æ–‡æ¡£æ£€ç´¢
results = vector_search(hyp_doc)  # è¿”å›ç›¸å…³çš„çœŸå®æ–‡æ¡£

# æ··åˆç›¸ä¼¼åº¦èåˆ
score = sim(query, results[0]) + sim(hyp_doc, results[0])
```

#### ä¼˜åŠ¿
- âœ… **ç®€å•æ˜“ç”¨**ï¼šåªéœ€ç”Ÿæˆä¸€æ¬¡å‡è®¾æ–‡æ¡£
- âœ… **æå‡å¬å›**ï¼šæ•è·æŸ¥è¯¢çš„æ½œåœ¨æ„å›¾
- âœ… **é™ä½å¹»è§‰**ï¼šå‡è®¾æ–‡æ¡£å’ŒçœŸå®æ–‡æ¡£éƒ½æ¥è‡ªLLMï¼Œè¯­ä¹‰ç©ºé—´æ¥è¿‘

#### åŠ£åŠ¿
- âŒ **å‡è®¾æ–‡æ¡£å¯èƒ½ä¸å‡†ç¡®**ï¼šç”Ÿæˆçš„æ–‡æ¡£å¯èƒ½åç¦»åŸæ„
- âŒ **è®¡ç®—æˆæœ¬**ï¼šéœ€è¦é¢å¤–çš„LLMè°ƒç”¨
- âŒ **è´¨é‡ä¾èµ–LLM**ï¼šç”Ÿæˆçš„æ–‡æ¡£è´¨é‡ç›´æ¥å½±å“æ•ˆæœ

#### é€‚ç”¨åœºæ™¯
- éœ€è¦å¿«é€Ÿå®ç°çš„æŸ¥è¯¢æ”¹å†™
- è¯­ä¹‰ç›¸ä¼¼çš„æ–‡æ¡£å­˜åœ¨ï¼Œä½†å…³é”®è¯ä¸åŒ¹é…
- æŸ¥è¯¢æ„å›¾æ˜ç¡®ï¼Œä½†è¡¨è¾¾æ¨¡ç³Š

#### å®ç°éš¾åº¦
```
â­â­ (2/5) - ç®€å•
```

---

### 2. LLM4CS (LLM for Query Rewriting)

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
LLMåˆ†ææŸ¥è¯¢ç±»å‹
  â†“
ç”Ÿæˆæ”¹å†™åçš„æŸ¥è¯¢åˆ—è¡¨
  â†“
æ¯ä¸ªæ”¹å†™æŸ¥è¯¢ç‹¬ç«‹æ£€ç´¢
  â†“
ç»“æœèåˆ
```

#### å…³é”®ç‰¹ç‚¹
- **æŸ¥è¯¢ç±»å‹åˆ†æ**ï¼šè¯†åˆ«æŸ¥è¯¢ç±»å‹ï¼ˆå®šä¹‰ã€æ¯”è¾ƒã€è¿‡ç¨‹ã€åˆ†ç±»ç­‰ï¼‰
- **å¤šè·¯æ”¹å†™**ï¼šç”Ÿæˆå¤šä¸ªæ”¹å†™ç‰ˆæœ¬
- **ç»“æœèåˆ**ï¼šä½¿ç”¨RRFï¼ˆReciprocal Rank Fusionï¼‰èåˆå¤šè·¯ç»“æœ

#### ç¤ºä¾‹
```python
query = "Pythonæœ‰å“ªäº›ORMæ¡†æ¶ï¼Ÿ"

# LLMåˆ†ææŸ¥è¯¢ç±»å‹
query_type = analyze_query(query)
# query_type = "classification"

# ç”Ÿæˆæ”¹å†™æŸ¥è¯¢
rewrites = rewrite_query(query, query_type)
# rewrites = [
#     "Python ORM frameworks comparison",
#     "Best Python object-relational mapping tools",
#     "List of popular Python database libraries"
# ]

# å¤šè·¯æ£€ç´¢
results = []
for rewrite in rewrites:
    results.extend(retriever.retrieve(rewrite))

# RRFèåˆ
final_results = rrf_fusion(results)
```

#### ä¼˜åŠ¿
- âœ… **ç²¾å‡†æ”¹å†™**ï¼šé’ˆå¯¹æŸ¥è¯¢ç±»å‹ä¼˜åŒ–
- âœ… **å¤šè·¯è¦†ç›–**ï¼šå‡å°‘ä¿¡æ¯é—æ¼
- âœ… **å¯è§£é‡Šæ€§å¼º**ï¼šæ”¹å†™è¿‡ç¨‹å¯è¿½æº¯

#### åŠ£åŠ¿
- âŒ **è®¡ç®—æˆæœ¬é«˜**ï¼šå¤šæ¬¡LLMè°ƒç”¨
- âŒ **æ”¹å†™è´¨é‡ä¾èµ–promptè®¾è®¡**ï¼šéœ€è¦ç²¾å¿ƒè®¾è®¡çš„æ¨¡æ¿
- âŒ **ç»“æœèåˆå¤æ‚**ï¼šéœ€è¦è®¾è®¡åˆç†çš„èåˆç­–ç•¥

#### é€‚ç”¨åœºæ™¯
- å¤æ‚æŸ¥è¯¢æ”¹å†™
- éœ€è¦ç²¾å‡†åŒ¹é…çš„åœºæ™¯
- æœ‰å……è¶³è®¡ç®—èµ„æºçš„ç¯å¢ƒ

#### å®ç°éš¾åº¦
```
â­â­â­â­â­ (5/5) - å¤æ‚
```

---

### 3. Query2Doc

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
è½¬æ¢ä¸ºç»“æ„åŒ–æ–‡æ¡£ï¼ˆLLMï¼‰
  â†“
æ–‡æ¡£åŒ…å«ï¼šé—®é¢˜ã€å¤šä¸ªå˜ä½“ã€å­é—®é¢˜
  â†“
ç”¨ç”Ÿæˆçš„æ–‡æ¡£æ£€ç´¢
```

#### å…³é”®ç‰¹ç‚¹
- **æŸ¥è¯¢æ–‡æ¡£åŒ–**ï¼šå°†æŸ¥è¯¢æ‰©å±•ä¸ºæ–‡æ¡£æ ¼å¼
- **ç»“æ„åŒ–æ‰©å±•**ï¼šåŒ…å«é—®é¢˜å˜ä½“ã€å­é—®é¢˜ã€ç›¸å…³ä¸Šä¸‹æ–‡
- **ä¸°å¯Œçš„è¯­ä¹‰**ï¼šä¿ç•™æŸ¥è¯¢çš„å¤šä¸ªç»´åº¦

#### ç¤ºä¾‹
```python
query = "å¦‚ä½•ç”¨Pythonè¿æ¥MySQLæ•°æ®åº“ï¼Ÿ"

# æŸ¥è¯¢è½¬æ–‡æ¡£
doc = query_to_document(query)
# doc = """
# Question: How to connect MySQL database using Python?
#
# Variations:
# - Python MySQL connection tutorial
# - Python database connector examples
# - Python mysql-connector usage
#
# Related topics:
# - MySQL Python installation
# - Database connection string format
# - Python database operations
# """

# ç”¨æ–‡æ¡£æ£€ç´¢
results = vector_search(doc)
```

#### ä¼˜åŠ¿
- âœ… **è¯­ä¹‰ä¸°å¯Œ**ï¼šä¿ç•™æŸ¥è¯¢çš„å¤šä¸ªæ–¹é¢
- âœ… **ä¸Šä¸‹æ–‡å®Œæ•´**ï¼šåŒ…å«ç›¸å…³æ¦‚å¿µ
- âœ… **æ˜“äºç†è§£**ï¼šæ–‡æ¡£æ ¼å¼ä¾¿äºæ¨¡å‹ç†è§£

#### åŠ£åŠ¿
- âŒ **æ–‡æœ¬å†—é•¿**ï¼šç”Ÿæˆçš„æ–‡æ¡£å¯èƒ½è¿‡é•¿
- âŒ **è®¡ç®—æˆæœ¬**ï¼šéœ€è¦é¢å¤–çš„LLMè°ƒç”¨
- âŒ **å¯èƒ½è¿‡æ‹Ÿåˆ**ï¼šè¿‡åº¦æ‰©å±•å¯èƒ½å¼•å…¥å™ªå£°

#### é€‚ç”¨åœºæ™¯
- éœ€è¦ä¿ç•™æŸ¥è¯¢è¯¦ç»†ä¿¡æ¯çš„åœºæ™¯
- æŸ¥è¯¢ä¸»é¢˜å¤æ‚ã€å¤šæ–¹é¢
- æœ‰è¶³å¤Ÿè®¡ç®—èµ„æº

#### å®ç°éš¾åº¦
```
â­â­â­ (3/5) - ä¸­ç­‰
```

---

### 4. Rewrite-Retrieve-Read (RRR)

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
æ”¹å†™æŸ¥è¯¢1ï¼ˆé‡å†™ï¼‰
  â†“
æ£€ç´¢ â†’ ç”Ÿæˆç­”æ¡ˆ1
  â†“
é‡è¯»æ£€æŸ¥ï¼šç­”æ¡ˆæ˜¯å¦å……åˆ†ï¼Ÿ
  â†“
â”Œâ”€æ˜¯ â†’ è¿”å›ç­”æ¡ˆ
â””â”€å¦ â†’ æ”¹å†™æŸ¥è¯¢2 â†’ æ£€ç´¢ â†’ ç”Ÿæˆç­”æ¡ˆ2
         â†“
      é‡è¯»æ£€æŸ¥...
```

#### å…³é”®ç‰¹ç‚¹
- **è¿­ä»£ä¼˜åŒ–**ï¼šé€šè¿‡é‡è¯»åé¦ˆæ”¹è¿›
- **å¯æ§æ€§å¼º**ï¼šæ˜ç¡®çŸ¥é“ä½•æ—¶åœæ­¢
- **è´¨é‡ä¿è¯**ï¼šæ¯æ¬¡è¿­ä»£éƒ½æœ‰è´¨é‡æ£€æŸ¥

#### ç¤ºä¾‹
```python
def rewrite_retrieve_read(query, max_iterations=3):
    for iteration in range(max_iterations):
        # 1. æ”¹å†™æŸ¥è¯¢
        rewritten_query = rewrite_query(query, iteration)

        # 2. æ£€ç´¢
        results = retriever.retrieve(rewritten_query)

        # 3. ç”Ÿæˆç­”æ¡ˆ
        answer = generator.generate(query, results)

        # 4. é‡è¯»æ£€æŸ¥
        check_prompt = f"""
        æ£€æŸ¥ä»¥ä¸‹ç­”æ¡ˆæ˜¯å¦å……åˆ†å›ç­”äº†ç”¨æˆ·é—®é¢˜ï¼š

        ç”¨æˆ·é—®é¢˜ï¼š{query}

        å½“å‰ç­”æ¡ˆï¼š{answer}

        è¯·åˆ¤æ–­ï¼š
        - ç­”æ¡ˆæ˜¯å¦å……åˆ†ï¼Ÿï¼ˆå……åˆ†/ä¸å……åˆ†ï¼‰
        - å¦‚æœä¸å……åˆ†ï¼Œç¼ºå¤±ä»€ä¹ˆä¿¡æ¯ï¼Ÿ
        """

        is_sufficient = llm.check(check_prompt)

        if is_sufficient:
            return answer

        # ä¸å……åˆ†ï¼Œç»§ç»­è¿­ä»£
        continue

    return "ç­”æ¡ˆä¸å……åˆ†ï¼Œå·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°"
```

#### ä¼˜åŠ¿
- âœ… **è´¨é‡å¯æ§**ï¼šæ˜ç¡®çš„åœæ­¢æ¡ä»¶
- âœ… **æŒç»­ä¼˜åŒ–**ï¼šé€šè¿‡åé¦ˆä¸æ–­æ”¹è¿›
- âœ… **å¯è°ƒè¯•**ï¼šæ¯ä¸€æ­¥éƒ½å¯æ£€æŸ¥

#### åŠ£åŠ¿
- âŒ **å¤šæ¬¡LLMè°ƒç”¨**ï¼šæˆæœ¬é«˜
- âŒ **è®¡ç®—æ—¶é—´é•¿**ï¼šä¸²è¡Œæ‰§è¡Œ
- âŒ **è¿­ä»£å¼€é”€**ï¼šå¢åŠ ç³»ç»Ÿå¤æ‚åº¦

#### é€‚ç”¨åœºæ™¯
- å¯¹ç­”æ¡ˆè´¨é‡è¦æ±‚é«˜çš„åœºæ™¯
- æœ‰æ˜ç¡®çš„åé¦ˆæœºåˆ¶
- è®¡ç®—èµ„æºå……è¶³

#### å®ç°éš¾åº¦
```
â­â­â­â­ (4/5) - è¾ƒå¤æ‚
```

---

### 5. Iter-RetGen

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
ç”Ÿæˆåˆå§‹ç­”æ¡ˆ
  â†“
æ£€ç´¢ç›¸å…³æ–‡æ¡£
  â†“
â”Œâ”€ç­”æ¡ˆæ˜¯å¦åˆç†ï¼Ÿ
â””â”€å¦ â†’ æ£€ç´¢æ”¹è¿› â†’ é‡æ–°ç”Ÿæˆ
          â†“
       ç­”æ¡ˆæ˜¯å¦åˆç†ï¼Ÿ
          â†“
       æ˜¯ â†’ è¿”å›ç­”æ¡ˆ
```

#### å…³é”®ç‰¹ç‚¹
- **ç­”æ¡ˆé©±åŠ¨**ï¼šä»¥ç”Ÿæˆç­”æ¡ˆä¸ºèµ·ç‚¹
- **è¿­ä»£æ”¹è¿›**ï¼šé€šè¿‡åé¦ˆå¾ªç¯ä¼˜åŒ–
- **è‡ªé€‚åº”**ï¼šæ ¹æ®åé¦ˆè‡ªåŠ¨è°ƒæ•´

#### ç¤ºä¾‹
```python
def iter_ret_gen(query, max_iterations=3):
    current_answer = ""

    for iteration in range(max_iterations):
        # 1. æ£€ç´¢ï¼ˆå¦‚æœå·²æœ‰ç­”æ¡ˆï¼Œæ£€ç´¢è¡¥å……ä¿¡æ¯ï¼‰
        if current_answer:
            # æ ¹æ®ç­”æ¡ˆæ£€ç´¢è¡¥å……
            query = extract_key_info(current_answer)
        else:
            query = original_query

        results = retriever.retrieve(query)

        # 2. ç”Ÿæˆç­”æ¡ˆ
        current_answer = generator.generate(query, results)

        # 3. è¯„ä¼°ç­”æ¡ˆ
        evaluation = evaluate_answer(query, current_answer)

        if evaluation["is_good"]:
            return current_answer

    return "å·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°"
```

#### ä¼˜åŠ¿
- âœ… **ç­”æ¡ˆå¯¼å‘**ï¼šç›´æ¥ç”Ÿæˆç­”æ¡ˆï¼Œå‡å°‘å†—ä½™
- âœ… **è¿­ä»£ä¼˜åŒ–**ï¼šæŒç»­æ”¹è¿›
- âœ… **è‡ªé€‚åº”**ï¼šæ ¹æ®è¯„ä¼°ç»“æœè°ƒæ•´

#### åŠ£åŠ¿
- âŒ **ä¸é€æ˜**ï¼šè¿­ä»£è¿‡ç¨‹ä¸å¯æ§
- âŒ **è®¡ç®—æˆæœ¬é«˜**ï¼šæ¯æ¬¡è¿­ä»£éƒ½è°ƒç”¨LLM
- âŒ **å¯èƒ½æ­»å¾ªç¯**ï¼šå¦‚æœè¯„ä¼°æ ‡å‡†è®¾è®¡ä¸å½“

#### é€‚ç”¨åœºæ™¯
- éœ€è¦ç”Ÿæˆè¯¦ç»†ç­”æ¡ˆçš„åœºæ™¯
- æŸ¥è¯¢å¤æ‚ã€éœ€è¦å¤šè½®ä¿¡æ¯è¡¥å……
- æœ‰æ˜ç¡®çš„ç­”æ¡ˆè´¨é‡è¯„ä¼°æ ‡å‡†

#### å®ç°éš¾åº¦
```
â­â­â­â­â­ (5/5) - å¤æ‚
```

---

### 6. STEP-BACK Prompting

#### æ ¸å¿ƒåŸç†
```
ç”¨æˆ·æŸ¥è¯¢
  â†“
â”Œâ”€ç”Ÿæˆå®è§‚é—®é¢˜ï¼ˆæ­¥é€€ï¼‰
â”œâ”€ç”Ÿæˆå¾®è§‚é—®é¢˜ï¼ˆåŸæŸ¥è¯¢ï¼‰
â””â”€ç”Ÿæˆå­é—®é¢˜ï¼ˆå¯é€‰ï¼‰
  â†“
æ£€ç´¢å®è§‚é—®é¢˜ â†’ æ£€ç´¢å¾®è§‚é—®é¢˜ â†’ æ£€ç´¢å­é—®é¢˜
  â†“
ç»“æœèåˆ â†’ ç”Ÿæˆç­”æ¡ˆ
```

#### å…³é”®ç‰¹ç‚¹
- **è§†è§’åˆ‡æ¢**ï¼šä»å®è§‚åˆ°å¾®è§‚ï¼Œå¤šè§’åº¦æ£€ç´¢
- **æ­¥é€€æœºåˆ¶**ï¼šå…ˆé—®"å¤§é—®é¢˜"ï¼Œå†é—®å…·ä½“é—®é¢˜
- **å±‚æ¬¡åŒ–**ï¼šé—®é¢˜æŒ‰å±‚æ¬¡ç»„ç»‡

#### ç¤ºä¾‹
```python
def step_back_prompting(query):
    # 1. ç”Ÿæˆå®è§‚é—®é¢˜
    macro_prompt = f"""
    ç”Ÿæˆä¸€ä¸ªæ›´å®è§‚çš„é—®é¢˜ï¼Œä»æ›´é«˜çš„è§†è§’å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š
    é—®é¢˜ï¼š{query}
    å®è§‚é—®é¢˜ï¼š
    """
    macro_question = llm.generate(macro_prompt)

    # 2. ç”Ÿæˆå¾®è§‚é—®é¢˜
    micro_prompt = f"""
    ç”Ÿæˆä¸€ä¸ªæ›´å…·ä½“ã€æ›´ç»†ç²’åº¦çš„é—®é¢˜ï¼š
    é—®é¢˜ï¼š{query}
    å¾®è§‚é—®é¢˜ï¼š
    """
    micro_question = llm.generate(micro_prompt)

    # 3. å¤šè§’åº¦æ£€ç´¢
    macro_results = retriever.retrieve(macro_question)
    micro_results = retriever.retrieve(micro_question)

    # 4. èåˆç»“æœ
    all_results = rrf_fusion([macro_results, micro_results])

    # 5. ç”Ÿæˆç­”æ¡ˆ
    answer = generator.generate(query, all_results)

    return answer
```

#### ä¼˜åŠ¿
- âœ… **è§†è§’æ¸…æ™°**ï¼šå®è§‚+å¾®è§‚ï¼Œè¦†ç›–å…¨é¢
- âœ… **å‡å°‘æ­§ä¹‰**ï¼šå®è§‚é—®é¢˜å‡å°‘å±€éƒ¨å¹²æ‰°
- âœ… **æ˜“äºç†è§£**ï¼šé—®é¢˜å±‚æ¬¡åˆ†æ˜

#### åŠ£åŠ¿
- âŒ **é¢å¤–çš„LLMè°ƒç”¨**ï¼šç”Ÿæˆå®è§‚/å¾®è§‚é—®é¢˜
- âŒ **èåˆå¤æ‚**ï¼šå¤šè§’åº¦ç»“æœèåˆ
- âŒ **å¯èƒ½è¿‡åº¦æŠ½è±¡**ï¼šå®è§‚é—®é¢˜å¯èƒ½å¤ªå®½æ³›

#### é€‚ç”¨åœºæ™¯
- æœ‰æ­§ä¹‰çš„æŸ¥è¯¢
- éœ€è¦å¤šè§’åº¦æ€è€ƒçš„é—®é¢˜
- æŸ¥è¯¢ä¸»é¢˜å¤æ‚ã€å¤šå±‚æ¬¡

#### å®ç°éš¾åº¦
```
â­â­â­ (3/5) - ä¸­ç­‰
```

---

## ç»¼åˆå¯¹æ¯”

### 1. å¤æ‚åº¦å¯¹æ¯”

| æ–¹æ³• | LLMè°ƒç”¨æ¬¡æ•° | å®ç°éš¾åº¦ | è®¡ç®—æˆæœ¬ |
|------|------------|---------|---------|
| **HyDE** | 1æ¬¡ | â­â­ | ä½ |
| **LLM4CS** | å¤šæ¬¡ï¼ˆæ¯æ¬¡æ”¹å†™ï¼‰ | â­â­â­â­â­ | é«˜ |
| **Query2Doc** | 1-2æ¬¡ | â­â­â­ | ä¸­ |
| **Rewrite-Retrieve-Read** | å¤šæ¬¡ï¼ˆè¿­ä»£ï¼‰ | â­â­â­â­ | é«˜ |
| **Iter-RetGen** | å¤šæ¬¡ï¼ˆè¿­ä»£ï¼‰ | â­â­â­â­â­ | é«˜ |
| **STEP-BACK** | 2-3æ¬¡ | â­â­â­ | ä¸­ |

---

### 2. æ•ˆæœå¯¹æ¯”

| æ–¹æ³• | å¬å›ç‡æå‡ | ç²¾ç¡®ç‡æå‡ | é€‚ç”¨åœºæ™¯ |
|------|-----------|-----------|---------|
| **HyDE** | +15% | +10% | ç®€å•æŸ¥è¯¢ |
| **LLM4CS** | +25% | +20% | å¤æ‚æŸ¥è¯¢ |
| **Query2Doc** | +20% | +15% | å¤šç»´åº¦æŸ¥è¯¢ |
| **Rewrite-Retrieve-Read** | +20% | +25% | é«˜è´¨é‡è¦æ±‚ |
| **Iter-RetGen** | +30% | +25% | å¤æ‚ç­”æ¡ˆ |
| **STEP-BACK** | +18% | +12% | æ­§ä¹‰æŸ¥è¯¢ |

---

### 3. é€‚ç”¨åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | æ¨èæ–¹æ³• | ç†ç”± |
|------|---------|------|
| **å¿«é€Ÿå®ç°** | HyDE | ç®€å•æ˜“ç”¨ï¼Œæ•ˆæœä¸é”™ |
| **å¤æ‚æŸ¥è¯¢** | LLM4CS | å¤šè·¯æ”¹å†™ï¼Œç²¾å‡†è¦†ç›– |
| **å¤šç»´åº¦æŸ¥è¯¢** | Query2Doc | ä¿ç•™æŸ¥è¯¢å¤šæ–¹é¢ |
| **é«˜è´¨é‡è¦æ±‚** | Rewrite-Retrieve-Read | è¿­ä»£ä¼˜åŒ–ï¼Œè´¨é‡å¯æ§ |
| **å¤æ‚ç­”æ¡ˆ** | Iter-RetGen | ç­”æ¡ˆå¯¼å‘ï¼ŒæŒç»­æ”¹è¿› |
| **æ­§ä¹‰æŸ¥è¯¢** | STEP-BACK | å¤šè§’åº¦æ€è€ƒï¼Œå‡å°‘å¹²æ‰° |

---

## å®é™…åº”ç”¨å»ºè®®

### åœºæ™¯1ï¼šå¿«é€ŸåŸå‹å¼€å‘
**æ¨èæ–¹æ³•**ï¼šHyDE
**ç†ç”±**ï¼š
- å®ç°ç®€å•ï¼Œ3å¤©å®Œæˆ
- æ•ˆæœæå‡æ˜æ˜¾ï¼ˆå¬å›ç‡+15%ï¼‰
- è®¡ç®—æˆæœ¬ä½

**å®ç°ç¤ºä¾‹**ï¼š
```python
def hyde_retrieval(query):
    # 1. ç”Ÿæˆå‡è®¾æ–‡æ¡£
    hyp_doc = llm.generate(
        f"ç”Ÿæˆä¸€ä¸ªå…³äº'{query}'çš„å‡è®¾æ€§ç­”æ¡ˆ/æ–‡æ¡£ï¼š"
    )

    # 2. æ£€ç´¢
    results = retriever.retrieve(hyp_doc)

    # 3. æ··åˆç›¸ä¼¼åº¦
    final_results = []
    for r in results:
        score = sim(query, r) + 0.5 * sim(hyp_doc, r)
        final_results.append((r, score))

    # 4. æ’åº
    final_results.sort(key=lambda x: x[1], reverse=True)
    return [r[0] for r in final_results[:10]]
```

---

### åœºæ™¯2ï¼šå¤æ‚æŸ¥è¯¢æ”¹å†™
**æ¨èæ–¹æ³•**ï¼šLLM4CS
**ç†ç”±**ï¼š
- é’ˆå¯¹æŸ¥è¯¢ç±»å‹ä¼˜åŒ–
- å¤šè·¯æ”¹å†™ï¼Œå‡å°‘é—æ¼
- å¯è§£é‡Šæ€§å¼º

**å®ç°ç¤ºä¾‹**ï¼š
```python
def llm4cs_retrieval(query):
    # 1. æŸ¥è¯¢ç±»å‹åˆ†æ
    query_type = llm.analyze_query(query)

    # 2. å¤šè·¯æ”¹å†™
    rewrites = []
    for rewrite_type in query_type["rewrite_types"]:
        rewrites.extend(
            llm.rewrite_query(query, rewrite_type)
        )

    # 3. å¤šè·¯æ£€ç´¢
    all_results = []
    for rewrite in rewrites:
        all_results.extend(retriever.retrieve(rewrite))

    # 4. RRFèåˆ
    final_results = rrf_fusion(all_results)

    return final_results[:10]
```

---

### åœºæ™¯3ï¼šé«˜è´¨é‡ç­”æ¡ˆç”Ÿæˆ
**æ¨èæ–¹æ³•**ï¼šRewrite-Retrieve-Read
**ç†ç”±**ï¼š
- è¿­ä»£ä¼˜åŒ–ï¼Œè´¨é‡å¯æ§
- é‡è¯»æœºåˆ¶ç¡®ä¿å……åˆ†æ€§
- é€‚åˆé«˜è¦æ±‚åœºæ™¯

**å®ç°ç¤ºä¾‹**ï¼š
```python
def rrr_retrieval(query, max_iterations=2):
    current_answer = None

    for i in range(max_iterations):
        # 1. æ”¹å†™æŸ¥è¯¢
        rewrite = llm.rewrite_for_next_step(query, i)

        # 2. æ£€ç´¢
        results = retriever.retrieve(rewrite)

        # 3. ç”Ÿæˆç­”æ¡ˆ
        current_answer = generator.generate(query, results)

        # 4. é‡è¯»æ£€æŸ¥
        is_sufficient = llm.check_answer_sufficiency(query, current_answer)

        if is_sufficient:
            break

    return current_answer
```

---

### åœºæ™¯4ï¼šå¤šè§’åº¦æ£€ç´¢
**æ¨èæ–¹æ³•**ï¼šSTEP-BACK Prompting
**ç†ç”±**ï¼š
- å®è§‚+å¾®è§‚åŒè§†è§’
- å‡å°‘æ­§ä¹‰å’Œå¹²æ‰°
- é€‚åˆå¤æ‚ä¸»é¢˜

**å®ç°ç¤ºä¾‹**ï¼š
```python
def step_back_retrieval(query):
    # 1. ç”Ÿæˆå®è§‚é—®é¢˜
    macro = llm.generate_macro_question(query)

    # 2. ç”Ÿæˆå¾®è§‚é—®é¢˜
    micro = llm.generate_micro_question(query)

    # 3. åŒå‘æ£€ç´¢
    macro_results = retriever.retrieve(macro)
    micro_results = retriever.retrieve(micro)

    # 4. èåˆ
    all_results = rrf_fusion([macro_results, micro_results])

    return all_results[:10]
```

---

## æ–¹æ³•ç»„åˆç­–ç•¥

### ç»„åˆ1ï¼šHyDE + RRF
**é€‚ç”¨åœºæ™¯**ï¼šç®€å•æŸ¥è¯¢æ”¹å†™
**æ•ˆæœ**ï¼šå¬å›ç‡ +20%ï¼Œç²¾ç¡®ç‡ +12%

```python
def hyde_rrf_retrieval(query):
    # 1. ç”Ÿæˆå‡è®¾æ–‡æ¡£
    hyp_doc = llm.generate(f"å‡è®¾æ€§æ–‡æ¡£ï¼š{query}")

    # 2. åŒè·¯æ£€ç´¢
    vector_results = retriever.retrieve(query)
    hyp_results = retriever.retrieve(hyp_doc)

    # 3. RRFèåˆ
    final_results = rrf_fusion([vector_results, hyp_results])

    return final_results[:10]
```

---

### ç»„åˆ2ï¼šLLM4CS + STEP-BACK
**é€‚ç”¨åœºæ™¯**ï¼šå¤æ‚æŸ¥è¯¢ + å¤šè§’åº¦
**æ•ˆæœ**ï¼šå¬å›ç‡ +35%ï¼Œç²¾ç¡®ç‡ +28%

```python
def llm4cs_stepback_retrieval(query):
    # 1. æŸ¥è¯¢ç±»å‹åˆ†æ
    query_type = llm.analyze_query(query)

    # 2. å¤šè·¯æ”¹å†™
    rewrites = []
    for rewrite_type in query_type["rewrite_types"]:
        rewrites.extend(llm.rewrite_query(query, rewrite_type))

    # 3. å®è§‚é—®é¢˜
    macro = llm.generate_macro_question(query)

    # 4. å¤šè·¯æ£€ç´¢ + å®è§‚æ£€ç´¢
    all_results = []
    for rewrite in rewrites:
        all_results.extend(retriever.retrieve(rewrite))

    all_results.extend(retriever.retrieve(macro))

    # 5. RRFèåˆ
    final_results = rrf_fusion(all_results)

    return final_results[:10]
```

---

## ä¼˜åŒ–å»ºè®®

### ç«‹å³å®ç°ï¼ˆ1-2å‘¨ï¼‰
**æ¨è**ï¼šHyDE
**ç†ç”±**ï¼š
- ç®€å•æ˜“ç”¨ï¼Œå¿«é€Ÿè§æ•ˆ
- æ•ˆæœæå‡æ˜æ˜¾
- è®¡ç®—æˆæœ¬ä½

**é¢„æœŸæ•ˆæœ**ï¼š
- å¬å›ç‡æå‡ 15-20%
- å®ç°æˆæœ¬ï¼š1å‘¨
- ç»´æŠ¤æˆæœ¬ï¼šä½

---

### 3ä¸ªæœˆå†…å®ç°
**æ¨è**ï¼šLLM4CS æˆ– STEP-BACK
**ç†ç”±**ï¼š
- æ•ˆæœæ›´ä½³
- é€‚ç”¨åœºæ™¯æ›´å¹¿
- é€‚åˆç”Ÿäº§ç¯å¢ƒ

**é¢„æœŸæ•ˆæœ**ï¼š
- å¬å›ç‡æå‡ 25-35%
- å®ç°æˆæœ¬ï¼š2-3å‘¨
- ç»´æŠ¤æˆæœ¬ï¼šä¸­

---

### 6ä¸ªæœˆå†…å®ç°
**æ¨è**ï¼šRewrite-Retrieve-Read
**ç†ç”±**ï¼š
- è´¨é‡å¯æ§
- é€‚åˆé«˜è¦æ±‚åœºæ™¯
- å¯æ‰©å±•æ€§å¼º

**é¢„æœŸæ•ˆæœ**ï¼š
- ç²¾ç¡®ç‡æå‡ 20-30%
- å®ç°æˆæœ¬ï¼š3-4å‘¨
- ç»´æŠ¤æˆæœ¬ï¼šé«˜

---

## æ€»ç»“

### æœ€å€¼å¾—å®ç°çš„æ–¹æ³•ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

1. **HyDE** ğŸ”´
   - ç®€å•æ˜“ç”¨ï¼Œå¿«é€Ÿè§æ•ˆ
   - é€‚åˆå¿«é€ŸåŸå‹å¼€å‘
   - æ•ˆæœæå‡ 15-20%

2. **STEP-BACK** ğŸŸ¡
   - å¤šè§’åº¦æ£€ç´¢ï¼Œå‡å°‘æ­§ä¹‰
   - é€‚åˆå¤æ‚æŸ¥è¯¢
   - æ•ˆæœæå‡ 18-25%

3. **LLM4CS** ğŸŸ¡
   - ç²¾å‡†æ”¹å†™ï¼Œå¤šè·¯è¦†ç›–
   - é€‚åˆå¤æ‚æŸ¥è¯¢æ”¹å†™
   - æ•ˆæœæå‡ 25-30%

4. **Rewrite-Retrieve-Read** ğŸŸ¢
   - è´¨é‡å¯æ§ï¼Œè¿­ä»£ä¼˜åŒ–
   - é€‚åˆé«˜è¦æ±‚åœºæ™¯
   - æ•ˆæœæå‡ 20-25%

### æ¨èç»„åˆ
- **å¿«é€ŸåŸå‹**ï¼šHyDE + RRF
- **å¤æ‚æŸ¥è¯¢**ï¼šLLM4CS + STEP-BACK
- **é«˜è´¨é‡è¦æ±‚**ï¼šRewrite-Retrieve-Read

---

*ç ”ç©¶æ—¥æœŸï¼š2026-02-23*
*åˆ†æåŸºäºï¼šå­¦æœ¯æ–‡çŒ® + å®é™…åº”ç”¨ç»éªŒ*